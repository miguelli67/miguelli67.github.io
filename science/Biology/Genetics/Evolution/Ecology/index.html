<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Ecology</title>
<style>
  /* Layout & theme */
  :root {
    --brand:#0f6b7a;
    --brand-dark:#0c505b;
    --bg1:#d7f9ff;
    --card:#ffffff;
    --border:#dfecec;
    --shadow:0 6px 16px rgba(0,0,0,.08);
  }
  *{box-sizing:border-box}
  body{margin:0;font-family:'Segoe UI',system-ui,Arial,sans-serif;background:linear-gradient(135deg,var(--bg1),#ffffff);color:#233}
  .wrap{max-width:1100px;margin:0 auto;padding:40px 20px}
  h1,h2{color:var(--brand);text-align:center;margin:0 0 12px}
  p.lead{text-align:center;margin:8px auto 28px;max-width:820px}
  .btn{display:inline-block;background:var(--brand);color:#fff;padding:10px 16px;border-radius:8px;text-decoration:none;font-weight:700;border:none;cursor:pointer}
  .btn:hover{background:var(--brand-dark)}
  .muted{color:#556;opacity:.9}
  .spacer{height:26px}
  .center{text-align:center}

  /* Biome flip cards */
  .grid{display:grid;gap:14px}
  @media(min-width:800px){.grid{grid-template-columns:repeat(3,1fr)}}
  .card{perspective:1000px;height:180px}
  .face{position:relative;height:100%;transform-style:preserve-3d;transition:transform .6s}
  .card.flipped .face{transform:rotateY(180deg)}
  .front,.back{position:absolute;inset:0;border-radius:12px;padding:14px;box-shadow:var(--shadow);backface-visibility:hidden}
  .front{background:var(--card);border:1px solid #d7eef2;display:flex;align-items:center;justify-content:center;font-weight:700}
  .back{background:#f7feff;border:1px solid #cfe6ea;transform:rotateY(180deg);font-size:.98rem;line-height:1.45}

  /* Drag & drop: roles */
  .roles{display:grid;gap:12px;margin-top:10px}
  @media(min-width:900px){.roles{grid-template-columns:280px 1fr}}
  .panel{background:var(--card);border:1px solid var(--border);border-radius:10px;padding:12px;box-shadow:0 4px 12px rgba(0,0,0,.05)}
  .chips{display:flex;flex-wrap:wrap;gap:8px;min-height:44px}
  .chip{
    user-select:none;background:#eef9f1;border-left:6px solid #2a7f62;border:1px solid #d4eadb;
    border-radius:999px;padding:6px 10px;cursor:grab; -webkit-user-drag: element;
  }
  .chip--selected{outline:3px solid #b7e9d1}
  .zonewrap{display:grid;gap:10px}
  @media(min-width:900px){.zonewrap{grid-template-columns:repeat(3,1fr)}}
  .zone{border:2px dashed #cfe6d9;border-radius:10px;padding:10px;min-height:110px;background:#fff}
  .zone h3{margin:0 0 6px;color:#145c4d;text-align:center}
  .zone.over{background:#f1fff7;box-shadow:inset 0 0 0 2px #8fe0c4}

  /* Food chain builder */
  .chain{display:flex;flex-wrap:wrap;gap:10px;justify-content:center;align-items:center;margin:10px 0}
  .node{background:#fff;border:1px solid var(--border);border-radius:10px;padding:8px 12px;box-shadow:0 4px 12px rgba(0,0,0,.05)}
  .arrow{font-size:20px;color:#999}

  /* Quiz */
  .quiz{background:#ffffff;border:1px solid var(--border);border-radius:12px;padding:16px;box-shadow:var(--shadow);max-width:800px;margin:0 auto}
  .q{margin-bottom:14px}
  .q p{margin:0 0 6px;font-weight:700}
  .submit{display:block;margin:12px auto 0}
</style>
</head>
<body>
<div class="wrap">
  <h1>üåø Ecology</h1>
  <p class="lead">Ecology studies how organisms interact with each other and with their environment ‚Äî from organism ‚Üí population ‚Üí community ‚Üí ecosystem ‚Üí biosphere.</p>

  <!-- Biome flip cards -->
  <h2>Biomes (Tap/Click to Flip)</h2>
  <div class="grid" id="biomes">
    <div class="card"><div class="face">
      <div class="front">üåµ Desert</div>
      <div class="back">Hot days, cold nights, low rainfall. Plants store water; many animals are nocturnal.</div>
    </div></div>
    <div class="card"><div class="face">
      <div class="front">üå≤ Taiga</div>
      <div class="back">Coniferous forests with long winters. Moose, lynx; evergreen trees dominate.</div>
    </div></div>
    <div class="card"><div class="face">
      <div class="front">üå¥ Tropical Rainforest</div>
      <div class="back">Warm, wet, extremely biodiverse. Dense canopy and rapid nutrient cycling.</div>
    </div></div>
    <div class="card"><div class="face">
      <div class="front">üåæ Grassland</div>
      <div class="back">Seasonal rainfall; grasses dominate. Grazing herbivores and swift predators.</div>
    </div></div>
    <div class="card"><div class="face">
      <div class="front">‚ùÑÔ∏è Tundra</div>
      <div class="back">Permafrost, very cold, low-growing plants, short growing season.</div>
    </div></div>
    <div class="card"><div class="face">
      <div class="front">üå≥ Temperate Forest</div>
      <div class="back">Four seasons, deciduous trees, rich soil and diverse fauna.</div>
    </div></div>
  </div>

  <div class="spacer"></div>

  <!-- Drag & drop roles -->
  <h2>Sort the Organisms: Producer / Consumer / Decomposer</h2>
  <div class="roles">
    <div class="panel">
      <strong>Organism Pool</strong>
      <div class="chips" id="pool">
        <div class="chip" draggable="true">Grass</div>
        <div class="chip" draggable="true">Algae</div>
        <div class="chip" draggable="true">Oak Tree</div>
        <div class="chip" draggable="true">Rabbit</div>
        <div class="chip" draggable="true">Frog</div>
        <div class="chip" draggable="true">Wolf</div>
        <div class="chip" draggable="true">Hawk</div>
        <div class="chip" draggable="true">Zooplankton</div>
        <div class="chip" draggable="true">Mushroom</div>
        <div class="chip" draggable="true">Bacteria</div>
      </div>
      <div class="center" style="margin-top:10px;">
        <button class="btn" id="checkRoles">Check Answers</button>
        <button class="btn" id="resetRoles" style="background:#ececec;color:#222">Reset</button>
      </div>
      <p class="center" id="roleScore"></p>
    </div>

    <div class="panel">
      <div class="zonewrap">
        <div class="zone" data-accept="Producer"><h3>Producer</h3><div class="chips" id="dropProducer"></div></div>
        <div class="zone" data-accept="Consumer"><h3>Consumer</h3><div class="chips" id="dropConsumer"></div></div>
        <div class="zone" data-accept="Decomposer"><h3>Decomposer</h3><div class="chips" id="dropDecomposer"></div></div>
      </div>
      <p style="margin:10px 0 0"><strong>Hint:</strong> Producers make their own food (photosynthesis). Consumers eat other organisms. Decomposers break down dead matter and recycle nutrients.</p>
    </div>
  </div>

  <div class="spacer"></div>

  <!-- Food chain builder -->
  <h2>Build a Food Chain</h2>
  <div class="center" style="margin-bottom:10px">
    <label for="chainSel"><strong>Pick an ecosystem:</strong></label>
    <select id="chainSel">
      <option value="field">Field</option>
      <option value="pond">Pond</option>
      <option value="forest">Forest</option>
      <option value="ocean">Ocean</option>
    </select>
    <button class="btn" id="showChain">Show Chain</button>
  </div>
  <div class="chain" id="chainView"></div>
  <p class="center muted" style="max-width:760px;margin:10px auto">Energy flows from the sun ‚Üí producers ‚Üí consumers. About 10% of energy is transferred to the next level.</p>

  <div class="spacer"></div>

  <!-- Quick quiz -->
  <h2>Ecology Quick Quiz</h2>
  <div class="quiz">
    <div class="q">
      <p>1) A decomposer‚Äôs main role is to‚Ä¶</p>
      <label><input type="radio" name="q1" value="A"> Produce glucose from sunlight</label><br>
      <label><input type="radio" name="q1" value="B"> Hunt prey</label><br>
      <label><input type="radio" name="q1" value="C"> Break down dead matter and recycle nutrients</label>
    </div>
    <div class="q">
      <p>2) In most ecosystems, the original source of energy is‚Ä¶</p>
      <label><input type="radio" name="q2" value="A"> The sun</label><br>
      <label><input type="radio" name="q2" value="B"> Decomposers</label><br>
      <label><input type="radio" name="q2" value="C"> Apex predators</label>
    </div>
    <div class="q">
      <p>3) Which sequence best shows energy flow?</p>
      <label><input type="radio" name="q3" value="A"> Consumer ‚Üí Producer ‚Üí Decomposer</label><br>
      <label><input type="radio" name="q3" value="B"> Producer ‚Üí Consumer ‚Üí Decomposer</label><br>
      <label><input type="radio" name="q3" value="C"> Decomposer ‚Üí Consumer ‚Üí Producer</label>
    </div>
    <button class="btn submit" id="quizBtn">Submit</button>
    <p class="center" id="quizScore"></p>
  </div>

  <div class="center" style="margin-top:24px">
    <a class="btn" href="../index.html">Back to Biology</a>
  </div>
</div>

<script>
/* ---------- Biome flip cards ---------- */
document.querySelectorAll('#biomes .card').forEach(c=>{
  c.addEventListener('click', ()=> c.classList.toggle('flipped'));
});

/* ---------- Drag & drop roles (desktop + touch) ---------- */
const correctRoles = {
  Producer:  ["Grass","Algae","Oak Tree"],
  Consumer:  ["Rabbit","Wolf","Hawk","Frog","Zooplankton"],
  Decomposer:["Mushroom","Bacteria"]
};
const pool = document.getElementById('pool');
const zones = Array.from(document.querySelectorAll('.zone'));
const allDrops = [pool, ...zones.map(z=>z.querySelector('.chips'))]; // allow dropping back to pool too
let dragEl = null;

// Mark chips draggable and enable mouse+touch handlers
document.querySelectorAll('.chip').forEach(ch=>{
  ch.setAttribute('draggable','true');
  enableDnD(ch);
});

function enableDnD(el){
  // Desktop drag
  el.addEventListener('dragstart', e=>{
    dragEl = el;
    e.dataTransfer.setData('text/plain', el.textContent); // required in some browsers
    e.dataTransfer.effectAllowed = 'move';
    el.classList.add('chip--selected');
  });
  el.addEventListener('dragend', ()=>{
    if(dragEl) dragEl.classList.remove('chip--selected');
    dragEl = null;
  });

  // Touch pick
  el.addEventListener('touchstart', ()=>{
    // toggle select: tap once to pick, tap zone/pool to drop
    if(dragEl && dragEl!==el){ dragEl.classList.remove('chip--selected'); }
    dragEl = el.classList.contains('chip--selected') ? null : el;
    el.classList.toggle('chip--selected');
  }, {passive:true});
}

// Allow drop on pool and each zone .chips
allDrops.forEach(dropArea=>{
  const zone = dropArea.closest('.zone');

  // Desktop allow
  ['dragenter','dragover'].forEach(ev=>{
    dropArea.addEventListener(ev, e=>{
      e.preventDefault();                 // CRITICAL: allows dropping
      if(zone) zone.classList.add('over');
      if(e.dataTransfer) e.dataTransfer.dropEffect = 'move';
    });
  });
  ['dragleave','drop'].forEach(ev=>{
    dropArea.addEventListener(ev, ()=>{
      if(zone) zone.classList.remove('over');
    });
  });
  dropArea.addEventListener('drop', e=>{
    e.preventDefault();
    if(dragEl){ dropArea.appendChild(dragEl); dragEl.classList.remove('chip--selected'); dragEl = null; }
  });

  // Touch drop
  dropArea.addEventListener('touchstart', ()=>{
    if(dragEl){ dropArea.appendChild(dragEl); dragEl.classList.remove('chip--selected'); dragEl = null; }
  }, {passive:true});
});

// Reset + Check
document.getElementById('resetRoles').addEventListener('click', ()=>{
  document.querySelectorAll('.zone .chips .chip').forEach(ch=>pool.appendChild(ch));
  document.getElementById('roleScore').textContent = '';
  document.querySelectorAll('.chip').forEach(ch=>ch.classList.remove('chip--selected'));
});
document.getElementById('checkRoles').addEventListener('click', ()=>{
  let score = 0, total = document.querySelectorAll('.chip').length;
  zones.forEach(z=>{
    const expect = z.getAttribute('data-accept');
    const placed = Array.from(z.querySelectorAll('.chip')).map(n=>n.textContent);
    placed.forEach(name=>{
      if(correctRoles[expect].includes(name)) score++;
    });
  });
  document.getElementById('roleScore').textContent = `You placed ${score}/${total} correctly`;
});

/* ---------- Food chain builder ---------- */
const CHAINS = {
  field:  ["Sun","Grass (Producer)","Rabbit (Primary)","Fox (Secondary)","Hawk (Tertiary)"],
  pond:   ["Sun","Algae (Producer)","Zooplankton (Primary)","Minnow (Secondary)","Bass (Tertiary)"],
  forest: ["Sun","Oak (Producer)","Caterpillar (Primary)","Bird (Secondary)","Hawk (Tertiary)"],
  ocean:  ["Sun","Phytoplankton (Producer)","Zooplankton (Primary)","Small Fish (Secondary)","Tuna (Tertiary)"]
};
const chainSel = document.getElementById('chainSel');
const chainView = document.getElementById('chainView');
document.getElementById('showChain').addEventListener('click', ()=>{
  const key = chainSel.value;
  const arr = CHAINS[key];
  chainView.innerHTML = '';
  arr.forEach((n,i)=>{
    const node = document.createElement('div');
    node.className='node';
    node.textContent = n;
    chainView.appendChild(node);
    if(i < arr.length-1){
      const arrow = document.createElement('div');
      arrow.className='arrow';
      arrow.textContent = '‚ûú';
      chainView.appendChild(arrow);
    }
  });
});
// initial render
document.getElementById('showChain').click();

/* ---------- Quiz ---------- */
const key = { q1:"C", q2:"A", q3:"B" };
document.getElementById('quizBtn').addEventListener('click', ()=>{
  let score=0, total=Object.keys(key).length;
  for (const q in key){
    const sel = document.querySelector(`input[name="${q}"]:checked`);
    if(sel && sel.value===key[q]) score++;
  }
  document.getElementById('quizScore').textContent = `Score: ${score}/${total}`;
});
</script>
</body>
</html>
